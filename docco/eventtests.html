<!DOCTYPE html>

<html>
<head>
  <title>eventtests.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="asm-llvm.html">
                asm-llvm.js
              </a>
            
              
              <a class="source" href="bcompile.html">
                bcompile.js
              </a>
            
              
              <a class="source" href="binterp.html">
                binterp.js
              </a>
            
              
              <a class="source" href="browsercanvas.html">
                browsercanvas.js
              </a>
            
              
              <a class="source" href="bytecode-table.html">
                bytecode-table.js
              </a>
            
              
              <a class="source" href="canvastest.html">
                canvastest.js
              </a>
            
              
              <a class="source" href="ccanvas.html">
                ccanvas.js
              </a>
            
              
              <a class="source" href="crender-styles.html">
                crender-styles.js
              </a>
            
              
              <a class="source" href="crender.html">
                crender.js
              </a>
            
              
              <a class="source" href="ctiles.html">
                ctiles.js
              </a>
            
              
              <a class="source" href="events.html">
                events.js
              </a>
            
              
              <a class="source" href="eventtests.html">
                eventtests.js
              </a>
            
              
              <a class="source" href="extensions.html">
                extensions.js
              </a>
            
              
              <a class="source" href="global-es5.html">
                global-es5.js
              </a>
            
              
              <a class="source" href="global.html">
                global.js
              </a>
            
              
              <a class="source" href="html-escape.html">
                html-escape.js
              </a>
            
              
              <a class="source" href="jcompile.html">
                jcompile.js
              </a>
            
              
              <a class="source" href="json2.html">
                json2.js
              </a>
            
              
              <a class="source" href="nodemain.html">
                nodemain.js
              </a>
            
              
              <a class="source" href="parse.html">
                parse.js
              </a>
            
              
              <a class="source" href="render.html">
                render.js
              </a>
            
              
              <a class="source" href="render2.html">
                render2.js
              </a>
            
              
              <a class="source" href="require.html">
                require.js
              </a>
            
              
              <a class="source" href="stdlib.html">
                stdlib.js
              </a>
            
              
              <a class="source" href="str-escape.html">
                str-escape.js
              </a>
            
              
              <a class="source" href="tdop.html">
                tdop.js
              </a>
            
              
              <a class="source" href="tests.html">
                tests.js
              </a>
            
              
              <a class="source" href="text.html">
                text.js
              </a>
            
              
              <a class="source" href="tiles.html">
                tiles.js
              </a>
            
              
              <a class="source" href="tokenize.html">
                tokenize.js
              </a>
            
              
              <a class="source" href="top-level.html">
                top-level.js
              </a>
            
              
              <a class="source" href="ts.html">
                ts.js
              </a>
            
              
              <a class="source" href="write-rust-bytecode.html">
                write-rust-bytecode.js
              </a>
            
              
              <a class="source" href="write-rust-ops.html">
                write-rust-ops.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>eventtests.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>define([<span class="string">"events"</span>], <span class="keyword">function</span>(flapjax) {
<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">flapjax_tests</span><span class="params">(info, error)</span> {</span>

        <span class="keyword">var</span> a = <span class="function"><span class="keyword">function</span> <span class="params">(b, m)</span> {</span> (b? info : error)(<span class="string">'tests: '</span> + m); };</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>test strong single value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">var</span> sTest = <span class="function"><span class="keyword">function</span> <span class="params">(inpt, out, msg, k)</span>
        {</span>
                k = <span class="literal">true</span>;
                <span class="keyword">if</span> (inpt !== out)
                {
                        error(msg + <span class="string">' input: '</span> + inpt + <span class="string">' out: '</span> + out);
                        <span class="keyword">return</span> <span class="literal">false</span>;
                }
                <span class="keyword">else</span> { <span class="keyword">if</span> (k) {info(<span class="string">' . . . try: '</span> + msg);} }
                <span class="keyword">return</span> <span class="literal">true</span>;
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>test weak single value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">var</span> swTest = <span class="function"><span class="keyword">function</span> <span class="params">(inpt, out, msg, k)</span>
        {</span>
                <span class="keyword">if</span> (inpt != out)
                {
                        error(msg + <span class="string">' input: '</span> + inpt + <span class="string">' out: '</span> + out);
                        <span class="keyword">return</span> <span class="literal">false</span>;
                }
                <span class="keyword">else</span> { <span class="keyword">if</span> (k) {info(<span class="string">' . . . try: '</span> + msg);} }
                <span class="keyword">return</span> <span class="literal">true</span>;
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>test array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">var</span> aTest = <span class="function"><span class="keyword">function</span> <span class="params">(arr1, arr2, msg)</span>
        {</span>
                <span class="keyword">var</span> legit = <span class="literal">true</span>;

                <span class="keyword">if</span> (arr1.length != arr2.length)
                {
                        legit = <span class="literal">false</span>;
                        error(msg + <span class="string">' array lengths wrong        arr1: ['</span> + arr1.join(<span class="string">':::'</span>)
                                + <span class="string">']    arr2: ['</span> + arr2.join(<span class="string">':::'</span>) +<span class="string">']'</span>);
                }

                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; Math.min(arr1.length, arr2.length); i++)
                {
                        <span class="keyword">if</span> (arr1[i] !== arr2[i])
                        {
                                legit = <span class="literal">false</span>;
                                error(msg + <span class="string">'  bad arr entries ['</span> + i + <span class="string">']: '</span>
                                        + <span class="string">'        arr1: '</span> + arr1[i] + <span class="string">'         arr2:'</span> + arr2[i]);
                        }
                }
                <span class="keyword">if</span> (!legit)
                {
                        error(<span class="string">'^^^^^^: '</span> + msg + <span class="string">'        arr1: ['</span> + arr1.join(<span class="string">':::'</span>)
                                + <span class="string">']      arr2: ['</span> + arr2.join(<span class="string">':::'</span>) + <span class="string">']'</span>);
                }

                <span class="keyword">return</span> legit;
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>test array of arrays</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">var</span> aaTest = <span class="function"><span class="keyword">function</span> <span class="params">(arr1, arr2, msg)</span>
        {</span>
                <span class="keyword">var</span> legit = <span class="literal">true</span>;

                <span class="keyword">if</span> (arr1.length != arr2.length)
                {
                        legit = <span class="literal">false</span>;
                        error(msg + <span class="string">' array lengths wrong        arr1: ['</span> + arr1.join(<span class="string">':::'</span>)
                                + <span class="string">']      arr2: ['</span> + arr2.join(<span class="string">':::'</span>) +<span class="string">']'</span>);
                }

                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; Math.min(arr1.length, arr2.length); i++) {
                        legit = legit &amp;&amp; aTest(arr1[i], arr2[i], msg);
                }

                <span class="keyword">return</span> legit;
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>test testers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        sTest(<span class="number">1</span>, <span class="number">1</span>, <span class="string">'same1'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>sTest(1, 2, &#39;not same2&#39;);</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        aTest([], [], <span class="string">'same3'</span>);
        aTest([<span class="number">1</span>], [<span class="number">1</span>], <span class="string">'same4'</span>);
        aTest([<span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">2</span>], <span class="string">'same5'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>aTest([], [1], &#39;not same6&#39;);
aTest([1, 2], [1, 2, 3], &#39;not same7&#39;);
aTest([1,2], [1,3], &#39;not same8&#39;);</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="comment">/* proto =============================================*/</span>
        <span class="comment">/* lib _______________________________________________*/</span>
        info(<span class="string">'====flapjax.lib===='</span>);

        <span class="keyword">var</span> l = flapjax;

        <span class="keyword">var</span> bLib = <span class="literal">true</span>;
        <span class="keyword">var</span> bLSum = <span class="literal">true</span>;
        <span class="keyword">var</span> bLMax = <span class="literal">true</span>;
        <span class="keyword">var</span> bLMin = <span class="literal">true</span>;
        <span class="keyword">var</span> bLWMap = <span class="literal">true</span>;
        <span class="keyword">var</span> bLWMapM = <span class="literal">true</span>;
        <span class="keyword">var</span> bLWFoldL = <span class="literal">true</span>;
        <span class="keyword">var</span> bLWFoldLM = <span class="literal">true</span>;


        <span class="keyword">var</span> add1 = <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span><span class="keyword">return</span> <span class="number">1</span> + x;};
        <span class="keyword">var</span> diff = <span class="function"><span class="keyword">function</span> <span class="params">(n1, n2)</span> {</span><span class="keyword">return</span> n1 - n2;};
        bLWMapM &amp;= aTest(l.map(diff, []), [], <span class="string">'wmapm1'</span>);
        bLWMapM &amp;= aTest(l.map(diff, [<span class="number">1</span>,<span class="number">4</span>],[<span class="number">3</span>,<span class="number">5</span>]), [-<span class="number">2</span>,-<span class="number">1</span>], <span class="string">'wmapm2'</span>);
        bLWMapM &amp;= aTest(l.map(add1, [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>]), [<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">'wmapm3'</span>);
        a(bLWMapM, <span class="string">'map multiple'</span>);

    <span class="comment">/*
        var summer = function (x, acc) {return x + acc;};
        bLWFoldLM &amp;= sTest(l.fold(summer, 1, []), 1, 'wfold1');
        bLWFoldLM &amp;= sTest(l.fold(summer, 1, [1,2,3]), 7, 'wfold2');

        var summerm = function (n1, n2, acc) {return n1 + n2 + acc;};
        bLWFoldLM &amp;= sTest(l.fold(summerm, 1, [1,2,3],[1,2,1]), 11, 'wfoldlm1');
        bLWFoldLM &amp;= sTest(l.fold(summerm, 1, [], []), 1, 'wfoldlm2');

        var multsummerm = function (n1, n2, acc) {return n1 * n2 + acc;};
        bLWFoldLM &amp;= sTest(l.fold(multsummerm, 1, [2,5,7], [2, 11, 3]),
        81, 'wfoldlm3');

        a(bLWFoldLM, 'foldlm');
     */</span>

        bLib &amp;= bLSum &amp;&amp; bLMax &amp;&amp; bLMin &amp;&amp; bLWMap &amp;&amp; bLWMapM &amp;&amp; bLWFoldL &amp;&amp; bLWFoldLM;
        (bLib? info : error)(<span class="string">'====flapjax.lib===='</span>);

        <span class="keyword">var</span> b = flapjax.base;

        <span class="comment">/* engine ____________________________________________*/</span>
        info(<span class="string">'====flapjax.engine===='</span>);

        <span class="keyword">var</span> bEng = <span class="literal">true</span>;
        <span class="keyword">var</span> bStamp = <span class="literal">true</span>;

        <span class="keyword">var</span> e = flapjax.engine;

        <span class="keyword">var</span> bCreateNode = <span class="literal">true</span>;

        <span class="keyword">var</span> pulse2 = <span class="keyword">new</span> b.Pulse(<span class="number">70</span>, <span class="number">2</span>);
                <span class="keyword">var</span> recConst = <span class="number">0</span>;

        <span class="keyword">var</span> secondsNode =
                e.createNode(
                        [],
                        <span class="function"><span class="keyword">function</span> <span class="params">(pulse)</span> {</span>
                            <span class="keyword">return</span> pulse;
                        });

        <span class="keyword">var</span> secondsAdd1Node =
                e.createNode(
                        [secondsNode],
                        <span class="function"><span class="keyword">function</span> <span class="params">(pulse)</span> {</span>
                                recConst = pulse.value + <span class="number">1</span>;
                                pulse.value  = recConst;
                                <span class="keyword">return</span> pulse;
                        });

        bCreateNode &amp;= sTest(
                (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                        b.propagatePulse(pulse2, secondsNode); <span class="keyword">return</span> recConst;})(),
                <span class="number">3</span>,
                <span class="string">'createNode1'</span>);
        a(bCreateNode, <span class="string">'createNode'</span>);

        <span class="keyword">var</span> bConstantNode = <span class="literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>CSA HACK</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    e.createConstantNode = <span class="keyword">function</span>(nodes, val) {
        <span class="keyword">return</span> e.createNode(nodes, <span class="keyword">function</span>(pulse) { pulse.value = val; <span class="keyword">return</span> pulse; });
    };

        recConst = -<span class="number">2</span>;
        <span class="keyword">var</span> const1      = e.createConstantNode([], <span class="number">1</span>);
        <span class="keyword">var</span> receiveN =
                e.createNode(
                        [const1],
                        <span class="function"><span class="keyword">function</span> <span class="params">(pulse)</span> {</span>
                                recConst = pulse.value; <span class="keyword">return</span> pulse;});
        bConstantNode &amp;=
                sTest(
                        (<span class="keyword">function</span>(){b.propagatePulse(pulse2, const1); <span class="keyword">return</span> recConst;})(),
                        <span class="number">1</span>,
                        <span class="string">'constantNode1'</span>,
                        <span class="literal">false</span>);
        a(bConstantNode, <span class="string">'createConstantNode'</span>);

        bEng &amp;= bStamp &amp;&amp; bCreateNode &amp;&amp; bConstantNode;
                (bEng? info : error)(<span class="string">'====flapjax.engine===='</span>);


                <span class="comment">/* combinators ____________________________________________*/</span>
                info(<span class="string">'====flapjax.combinators===='</span>);
        <span class="keyword">var</span> bComb = <span class="literal">true</span>;
        <span class="keyword">var</span> c = flapjax.combinators;

        <span class="keyword">var</span> bEventReceiver = <span class="literal">true</span>;
        <span class="keyword">var</span> received = <span class="number">0</span>;
        <span class="keyword">var</span> receiver = flapjax.receiverE();
        <span class="keyword">var</span> passer = e.createNode([receiver], <span class="function"><span class="keyword">function</span> <span class="params">(p)</span> {</span>received = p.value; <span class="keyword">return</span> e.doNotPropagate;});

        bEventReceiver &amp;= sTest( (<span class="keyword">function</span>(){b.propagatePulse(pulse2, receiver); <span class="keyword">return</span> received;})(),
                <span class="number">2</span>, <span class="string">'createEventReceiver1'</span>);
        a(bEventReceiver, <span class="string">'createEventReceiver'</span>);

        <span class="keyword">var</span> bSendEvent = <span class="literal">true</span>;
        received = <span class="number">0</span>;

        bSendEvent &amp;= sTest( (<span class="keyword">function</span>(){flapjax.sendEvent(passer, <span class="number">3</span>); <span class="keyword">return</span> received;})(),
                <span class="number">3</span>, <span class="string">'sendEvent1'</span>);
        a(bSendEvent, <span class="string">'sendEvent'</span>);

        <span class="keyword">var</span> bMapEV = <span class="literal">true</span>;
        received = <span class="number">0</span>;
        <span class="keyword">var</span> receiver2 = flapjax.receiverE();
        <span class="keyword">var</span> doubler = flapjax.mapE(<span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span>received = <span class="number">2</span> * v; <span class="keyword">return</span> <span class="number">2</span>*v;}, receiver2);

        bMapEV &amp;= sTest( (<span class="keyword">function</span>(){flapjax.sendEvent(receiver2, <span class="number">3</span>); <span class="keyword">return</span> received;})(),
                <span class="number">6</span>, <span class="string">'bMapEV1'</span>);
        a(bMapEV, <span class="string">'mapE'</span>);

        <span class="keyword">var</span> bFilterEV = <span class="literal">true</span>;
        received = <span class="number">0</span>;
        <span class="keyword">var</span> receiver3 = flapjax.receiverE();
        <span class="keyword">var</span> gt5 = receiver3.filterE(<span class="keyword">function</span>(v){<span class="keyword">return</span> (v &gt; <span class="number">5</span>);});
        <span class="keyword">var</span> recorder = e.createNode([gt5], <span class="function"><span class="keyword">function</span> <span class="params">(p)</span> {</span>received = p.value; <span class="keyword">return</span> p;});

        bFilterEV &amp;= sTest((<span class="keyword">function</span>(){flapjax.sendEvent(receiver3, <span class="number">1</span>); <span class="keyword">return</span> received;})(),
                <span class="number">0</span>, <span class="string">'filter_ev1'</span>);
        received = <span class="number">0</span>;
        bFilterEV &amp;= sTest((<span class="keyword">function</span>(){flapjax.sendEvent(receiver3, <span class="number">6</span>); <span class="keyword">return</span> received;})(),
                <span class="number">6</span>, <span class="string">'filter_ev2'</span>);

        a(bFilterEV, <span class="string">'filter_ev'</span>);

    <span class="keyword">var</span> bFilterRepeatsE = <span class="literal">true</span>;
    bFilterRepeatsE &amp;= sTest((<span class="function"><span class="keyword">function</span> <span class="params">()</span>{</span>
            <span class="keyword">var</span> received = <span class="number">0</span>;
            <span class="keyword">var</span> receiver = flapjax.receiverE();
            <span class="keyword">var</span> f = receiver.filterRepeatsE();
            e.createNode([f], <span class="function"><span class="keyword">function</span> <span class="params">(p)</span> {</span> received += p.value; <span class="keyword">return</span> p;});
            flapjax.sendEvent(receiver, <span class="number">1</span>);
            flapjax.sendEvent(receiver, <span class="number">1</span>);
            <span class="keyword">return</span> received;})(), <span class="number">1</span>, <span class="string">'filterRepeats_e1'</span>);
     bFilterRepeatsE &amp;= sTest((<span class="function"><span class="keyword">function</span> <span class="params">()</span>{</span>
            <span class="keyword">var</span> received = <span class="number">0</span>;
            <span class="keyword">var</span> receiver = flapjax.receiverE();
            <span class="keyword">var</span> f = receiver.filterRepeatsE();
            e.createNode([f], <span class="function"><span class="keyword">function</span> <span class="params">(p)</span> {</span> received += p.value; <span class="keyword">return</span> (p);});
            flapjax.sendEvent(receiver, <span class="number">1</span>);
            flapjax.sendEvent(receiver, <span class="number">2</span>);
            flapjax.sendEvent(receiver, <span class="number">1</span>);
            <span class="keyword">return</span> received;})(), <span class="number">4</span>, <span class="string">'filterRepeats_e2'</span>);
     bFilterRepeatsE &amp;= sTest((<span class="function"><span class="keyword">function</span> <span class="params">()</span>{</span>
            <span class="keyword">var</span> received = <span class="string">'asdf'</span>;
            <span class="keyword">var</span> receiver = flapjax.receiverE();
            <span class="keyword">var</span> f = receiver.filterRepeatsE();
            e.createNode([f], <span class="function"><span class="keyword">function</span> <span class="params">(p)</span> {</span> received += p.value; <span class="keyword">return</span>(p);});
            flapjax.sendEvent(receiver, <span class="string">'a'</span>);
            flapjax.sendEvent(receiver, <span class="string">'a'</span>);
            <span class="keyword">return</span> received;})(), <span class="string">'asdfa'</span>, <span class="string">'filterRepeats_e3'</span>);
     a(bFilterRepeatsE, <span class="string">'filterRepeats_e3'</span>);


        <span class="keyword">var</span> bMergeE = <span class="literal">true</span>;
        <span class="keyword">var</span> mergeERcva = flapjax.receiverE();
        <span class="keyword">var</span> mergeERcvb = flapjax.receiverE();
        bMergeE &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                <span class="keyword">var</span> mergeERcvd0 = <span class="number">0</span>;
                <span class="keyword">var</span> mergeERcvr0 = flapjax.mergeE(mergeERcva);
                flapjax.mapE(<span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span><span class="keyword">return</span> (mergeERcvd0 = v);},
                mergeERcvr0);
                flapjax.sendEvent(mergeERcva, <span class="number">1</span>);
                <span class="keyword">return</span> mergeERcvd0; })(), <span class="number">1</span>, <span class="string">'merge_e1'</span>);
        bMergeE &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                <span class="keyword">var</span> mergeERcvd1 = <span class="number">1</span>;
                <span class="keyword">var</span> mergeERcvr1 = flapjax.mergeE(mergeERcva, mergeERcvb);
                flapjax.mapE(<span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span> <span class="keyword">return</span> (mergeERcvd1 *= v); },
                mergeERcvr1);
                flapjax.sendEvent(mergeERcva, <span class="number">3</span>);
                flapjax.sendEvent(mergeERcvb, <span class="number">5</span>);
                <span class="keyword">return</span> mergeERcvd1; })(), <span class="number">15</span>, <span class="string">'merge_e2'</span>);
        a(bMergeE, <span class="string">'merge_e'</span>);

        <span class="keyword">var</span> bOnceE = <span class="literal">true</span>;
        <span class="keyword">var</span> onceERcvE = flapjax.receiverE();
        bOnceE &amp;= sTest(
                (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                        <span class="keyword">var</span> result = <span class="number">0</span>;
                        flapjax.mapE(
                                <span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span> result = v; <span class="keyword">return</span> v; },
                                flapjax.onceE(onceERcvE));
                        flapjax.sendEvent(onceERcvE, <span class="number">1</span>);
                        flapjax.sendEvent(onceERcvE, <span class="number">2</span>);
                        <span class="keyword">return</span> result; })(),
                <span class="number">1</span>,
                <span class="string">'once_e1'</span>);

        a(bOnceE, <span class="string">'once_e'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>TODO test collect_e</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">var</span> bSwitchE = <span class="literal">true</span>;

        bSwitchE &amp;=
                sTest(
                        (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                                <span class="keyword">var</span> stream1 = flapjax.receiverE();
                                <span class="keyword">var</span> stream2 = flapjax.receiverE();
                                <span class="keyword">var</span> streamReceiverE = flapjax.receiverE();
                                <span class="keyword">var</span> switchedE = flapjax.switchE(streamReceiverE);
                                <span class="keyword">var</span> lastReceived = <span class="literal">undefined</span>;
                                flapjax.mapE(
                                        <span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span> lastReceived = v; },
                                        switchedE);
                                flapjax.sendEvent(streamReceiverE, stream1);
                                flapjax.sendEvent(stream1, <span class="number">1</span>);
                                <span class="keyword">return</span> lastReceived;
                        })(),
                        <span class="number">1</span>,
                        <span class="string">'switch_e1'</span>);

        bSwitchE &amp;=
                sTest(
                        (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                                <span class="keyword">var</span> stream1 = flapjax.receiverE();
                                <span class="keyword">var</span> stream2 = flapjax.receiverE();
                                <span class="keyword">var</span> streamReceiverE = flapjax.receiverE();
                                <span class="keyword">var</span> switchedE = flapjax.switchE(streamReceiverE);
                                <span class="keyword">var</span> lastReceived = <span class="literal">undefined</span>;
                                flapjax.mapE(
                                        <span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span> lastReceived = v; },
                                        switchedE);
                                flapjax.sendEvent(streamReceiverE, stream1);
                                flapjax.sendEvent(streamReceiverE, stream2);
                                flapjax.sendEvent(stream2, <span class="number">2</span>);
                                <span class="keyword">return</span> lastReceived;
                        })(),
                        <span class="number">2</span>,
                        <span class="string">'switch_e2'</span>);

        bSwitchE &amp;=
                sTest(
                        (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                                <span class="keyword">var</span> stream1 = flapjax.receiverE();
                                <span class="keyword">var</span> stream2 = flapjax.receiverE();
                                <span class="keyword">var</span> streamReceiverE = flapjax.receiverE();
                                <span class="keyword">var</span> switchedE = flapjax.switchE(streamReceiverE);
                                <span class="keyword">var</span> lastReceived = <span class="literal">undefined</span>;
                                flapjax.mapE(
                                        <span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span> lastReceived = v; },
                                        switchedE);
                                flapjax.sendEvent(streamReceiverE, stream1);
                                flapjax.sendEvent(streamReceiverE, stream2);
                                flapjax.sendEvent(stream2, <span class="number">2</span>);
                                flapjax.sendEvent(stream1, <span class="number">1</span>);
                                <span class="keyword">return</span> lastReceived;
                        })(),
                        <span class="number">2</span>,
                        <span class="string">'switch_e3'</span>);

        a(bSwitchE, <span class="string">'switch_e'</span>);


        <span class="keyword">var</span> bIfE = <span class="literal">true</span>;
        received = <span class="number">0</span>;
        receiver3 = flapjax.receiverE();
        <span class="keyword">var</span> iffer = flapjax.ifE(
                receiver3,
                e.createConstantNode([receiver3], <span class="number">2</span>),
                        e.createConstantNode([receiver3], <span class="number">3</span>));
        <span class="keyword">var</span> receiver4 = e.createNode([iffer], <span class="function"><span class="keyword">function</span> <span class="params">(p)</span> {</span>
                 received = p.value; <span class="keyword">return</span> (p);});
        bIfE &amp;= sTest((<span class="keyword">function</span>(){
                        flapjax.sendEvent(receiver3, <span class="literal">true</span>); <span class="keyword">return</span> received;})(),
                <span class="number">2</span>, <span class="string">'if_e1'</span>);
        received = <span class="number">0</span>;
        bIfE &amp;= sTest((<span class="keyword">function</span>(){
                        flapjax.sendEvent(receiver3, <span class="literal">true</span>); <span class="keyword">return</span> received;})(),
                <span class="number">2</span>, <span class="string">'if_e2'</span>);
        received = <span class="number">0</span>;
        bIfE &amp;= sTest((<span class="keyword">function</span>(){
                        flapjax.sendEvent(receiver3, <span class="literal">false</span>); <span class="keyword">return</span> received;})(),
                <span class="number">3</span>, <span class="string">'if_e3'</span>);
        received = <span class="number">0</span>;
        bIfE &amp;= sTest((<span class="keyword">function</span>(){
                        flapjax.sendEvent(receiver3, <span class="literal">false</span>); <span class="keyword">return</span> received;})(),
                <span class="number">3</span>, <span class="string">'if_e4'</span>);
        received = <span class="number">0</span>;
        bIfE &amp;= sTest((<span class="keyword">function</span>(){
                        flapjax.sendEvent(receiver3, <span class="literal">true</span>); <span class="keyword">return</span> received;})(),
                <span class="number">2</span>, <span class="string">'if_e5'</span>);
        received = <span class="number">0</span>;
        bIfE &amp;= sTest((<span class="keyword">function</span>(){
                        flapjax.sendEvent(receiver3, <span class="literal">false</span>); <span class="keyword">return</span> received;})(),
                <span class="number">3</span>, <span class="string">'if_e6'</span>);
        <span class="keyword">var</span> ifReceiver5 = flapjax.receiverE();
        <span class="keyword">var</span> ifReceiver6b = flapjax.receiverE();
        <span class="keyword">var</span> iffer2 = flapjax.ifE(ifReceiver5, ifReceiver5, ifReceiver6b);
        <span class="keyword">var</span> ifReceiver6 = e.createNode([iffer2], <span class="function"><span class="keyword">function</span> <span class="params">(p)</span> {</span>
                        received = p.value; <span class="keyword">return</span> (p); });
        received = <span class="number">0</span>;
        bIfE &amp;= sTest((<span class="keyword">function</span>(){
                        flapjax.sendEvent(ifReceiver5, <span class="literal">true</span>); <span class="keyword">return</span> received;})(),
                        <span class="literal">true</span>, <span class="string">'if_e7'</span>);
        received = <span class="number">0</span>;
        bIfE &amp;= sTest((<span class="keyword">function</span>(){
                        flapjax.sendEvent(ifReceiver5, <span class="literal">false</span>); <span class="keyword">return</span> received;})(),
                        <span class="number">0</span>, <span class="string">'if_e8'</span>);
        a(bIfE, <span class="string">'if_e'</span>);

        <span class="keyword">var</span> bCondE = <span class="literal">true</span>;
    <span class="comment">/*
        var rcvCond1 = flapjax.receiverE();
        var conder1 = flapjax.condE();
        bCondE &amp;= sTest((function(){
                        received = 0;
                flapjax.sendEvent(rcvCond1, 1);
                return received;})(),
                0, 'cond_e1');

        var rcvCond2 = flapjax.receiverE();
        var conder2 = flapjax.condE(
                [e.createConstantNode([rcvCond2], true),
                        e.createConstantNode([rcvCond2], 2)]);
        var receiverCond2 = e.createNode([conder2], function (p) {
                received = p.value; return(p);});
        bCondE &amp;= sTest((function(){
                        received = 0;
                flapjax.sendEvent(rcvCond2, 1);
                return received;})(),
                2, 'cond_e2');

        var rcvCond = flapjax.receiverE();
        var m = function (f) { return flapjax.mapE(f, rcvCond);};
        var conder = flapjax.condE(
                [m(function(x){ return (x &lt; 0);}),
                 e.createConstantNode([rcvCond], -1)],
                [m(function(x){ return (x &lt; 1);}),
                 e.createConstantNode([rcvCond], 1)],
                [e.createConstantNode([rcvCond], true),
                 e.createConstantNode([rcvCond], 2)]);
        var receiverCond = e.createNode([conder], function(p) {
                received = p.value; return(p);});
        bCondE &amp;= sTest((function(){
                        received = 0; flapjax.sendEvent(rcvCond, -1); return received;})(),
                -1, 'cond_e3');
        bCondE &amp;= sTest((function(){
                received = 0; flapjax.sendEvent(rcvCond, 0); return received;})(),
                1, 'cond_e4');
        bCondE &amp;= sTest((function(){
                received = 0; flapjax.sendEvent(rcvCond, 2); return received;})(),
                2, 'cond_e5');

        a(bCondE, 'cond_e');
*/</span>

        <span class="keyword">var</span> bAndE = <span class="literal">true</span>;
        <span class="keyword">var</span> andReceiver1 = flapjax.receiverE();
        <span class="keyword">var</span> and1N = flapjax.andE(andReceiver1);
        <span class="keyword">var</span> andResult = <span class="number">0</span>;
        <span class="keyword">var</span> andRecord1 = flapjax.mapE(
                <span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span>andResult = v; <span class="keyword">return</span> v;},
                and1N);
        bAndE &amp;= sTest( (<span class="keyword">function</span>(){
                        andResult = <span class="number">0</span>;
                        flapjax.sendEvent(andReceiver1, <span class="literal">true</span>);
                        <span class="keyword">return</span> andResult;})(),
                <span class="literal">true</span>, <span class="string">'and_e1'</span>);
        bAndE &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span>{</span>
                        andResult = <span class="number">0</span>;
                        flapjax.sendEvent(andReceiver1, <span class="literal">false</span>);
                        <span class="keyword">return</span> andResult;})(),
                <span class="literal">false</span>, <span class="string">'and_e2'</span>);

        <span class="keyword">var</span> andResult2 = <span class="number">0</span>;
        <span class="keyword">var</span> and2N = flapjax.andE(and1N, and1N);
        <span class="keyword">var</span> andRecord2 = flapjax.mapE(
                <span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span>andResult2 = v; <span class="keyword">return</span> v;},
                and2N);
        bAndE &amp;= sTest( (<span class="keyword">function</span>(){
                        andResult2 = -<span class="number">2</span>;
                        flapjax.sendEvent(andReceiver1, <span class="literal">true</span>);
                        <span class="keyword">return</span> andResult2;})(),
                <span class="literal">true</span>, <span class="string">'and_e3'</span>);



        bAndE &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span>{</span>
                        andResult2 = -<span class="number">2</span>;
                        flapjax.sendEvent(andReceiver1, <span class="literal">false</span>);
                        <span class="keyword">return</span> andResult2;})(),
                <span class="literal">false</span>, <span class="string">'and_e4'</span>);

        <span class="keyword">var</span> bOrE = <span class="literal">true</span>;

        <span class="keyword">var</span> bTimer = <span class="literal">true</span>;

        <span class="comment">/* should print a couple times */</span>
<span class="comment">/*
        var oftenTimer = c.createTimerNode(100);
        var timeReceiver = e.createNode([oftenTimer], function(s, p) {
                info('timer test (2x): ' + p.value); s(p); });
        setTimeout(function () {c.disableTimerNode(oftenTimer)}, 201);
*/</span>

        <span class="keyword">var</span> bDelay = <span class="literal">true</span>;


        <span class="comment">/* should print twice */</span>
    <span class="comment">/*
        var delayTimerE = c.createTimerNode(100);
        flapjax.mapE(
                function (v) {info('delay test received: ' + (new Date()).getTime()); return v;},
                c.delay_e(
                        flapjax.mapE(
                                function (v) { info('delay sent: ' + v); return v; },
                                delayTimerE),
                        30));
        setTimeout(function () {c.disableTimerNode(delayTimerE)}, 201);
*/</span>

        <span class="keyword">var</span> bLift = <span class="literal">true</span>;

        <span class="keyword">var</span> bLiftE = <span class="literal">true</span>;
        <span class="comment">/*
        var toLiftAddXY = function (x, y) { return x + y; };
        var liftX = flapjax.receiverE();
        var liftY = e.createConstantNode([liftX], 3);
        var lifted = c.lift_e(toLiftAddXY, liftX, liftY);
        var recordLift = e.createNode([lifted], function (s, p) {
                received = p.value; s(p); });
        bLiftE &amp;= sTest((function(){
                received = 0; flapjax.sendEvent(liftX, 4); return received;})(),
                7, 'bLiftE1');

        var liftZ = flapjax.receiverE();
        var lifted2 = c.lift_e(toLiftAddXY, liftZ, 20);
        var recordLift2 = e.createNode([lifted2], function (s, p) {
                received = p.value; s(p); });
        bLiftE &amp;= sTest((function(){
                received = 0; flapjax.sendEvent(liftZ, 5); return received;})(),
                25, 'bLiftE2');

        bLiftE &amp;= sTest((function(){
                        var success = true;
                        var start = 0;
                        var senderE = flapjax.receiverE();
                        var resE =
                                c.lift_e(
                                        function (v) { return v * 2; },
                                        c.collect_ev(
                                                senderE,
                                                0,
                                                function (_, acc) { return acc + 1; }));
                        e.createNode([resE], function (s, p) { start=p.value; });
                        success = success &amp;&amp; (start === 0);
                        flapjax.sendEvent(senderE, 'beep');
                        success = success &amp;&amp; (start === 2);
                        flapjax.sendEvent(senderE, 'beep');
                        success = success &amp;&amp; (start === 4);
                        return success;
                })(), true, 'bLiftE3');


        bLiftE &amp;= sTest((function(){
                        var success = true;
                        var start = 0;
                        var senderE = flapjax.receiverE();
                        var count4e = c.collect_ev(
                                senderE,
                                0,
                                function (_, acc) { return acc + 1; });
                        var count4e2 = flapjax.mapE(
                                function (v) { return v; },
                                count4e);

                        var resE = c.lift_e(
                                        function (l, r) { return l + r; },
                                        count4e,
                                        count4e2);
                        e.createNode([resE], function (s, p) { start=p.value; });
                        success = success &amp;&amp; (start === 0);
                        flapjax.sendEvent(senderE, 'beep');
                        success = success &amp;&amp; (start === 2);
                        flapjax.sendEvent(senderE, 'beep');
                        success = success &amp;&amp; (start === 4);
                        return success;
                })(), true, 'bLiftE4');

        bLiftE &amp;= sTest((function(){
                        var success = true;
                        var start = 0;
                        var senderE = flapjax.receiverE();
                        var count5e = c.collect_ev(
                                senderE,
                                0,
                                function (_, acc) { return acc + 1; });
                        var count5e2 = flapjax.mapE(
                                function (v) { return v; },
                                count5e);

                        var resE = c.lift_e(
                                        function (l, r) { return l + r; },
                                        count5e2,
                                        count5e);
                        e.createNode([resE], function (s, p) { start=p.value; });
                        success = success &amp;&amp; (start === 0);
                        flapjax.sendEvent(senderE, 'beep');
                        success = success &amp;&amp; (start === 2);
                        flapjax.sendEvent(senderE, 'beep');
                        success = success &amp;&amp; (start === 4);
                        return success;
                })(), true, 'bLiftE5');

        bLiftE &amp;= sTest((function(){
                        var success = true;
                        var start = 0;
                        var senderE = flapjax.receiverE();
                        var count6e = c.collect_ev(
                                senderE,
                                0,
                                function (_, acc) { return acc + 1; });
                        var lifteFn6 =
                                flapjax.mapE(
                                        function (p) {
                                                return function (c) {
                                                        return (p? 1 : -1) * c;
                                                };
                                        },
                                        c.collect_ev(
                                                count6e,
                                                false,
                                                function (_, acc) { return !acc; }));

                        var resE = c.lift_e(
                                        lifteFn6,
                                        count6e);

                        e.createNode([resE], function (s, p) { start=p.value; });
                        success = success &amp;&amp; (start === 0);
                        flapjax.sendEvent(senderE, 'beep');
                        success = success &amp;&amp; (start === 1);
                        flapjax.sendEvent(senderE, 'beep');
                        success = success &amp;&amp; (start === -2);
                        return success;
                })(), true, 'bLiftE6');

        bLiftE &amp;= sTest((function(){
                        var success = true;
                        var start = 0;
                        var senderE = flapjax.receiverE();
                        var count7e = c.collect_ev(
                                senderE,
                                0,
                                function (_, acc) { return acc + 1; });
                        var lifteFn7 =
                                c.lift_e(
                                        function (p) {
                                                return function (l, r) {
                                                        return (p? 1 : -1) * (l + r);
                                                };
                                        },
                                        c.collect_ev(
                                                count7e,
                                                false,
                                                function (_, acc) { return !acc; }));

                        var resE = c.lift_e(
                                        lifteFn7,
                                        count7e,
                                        count7e);

                        e.createNode([resE], function (s, p) { start=p.value; });
                        success = success &amp;&amp; (start === 0);
                        flapjax.sendEvent(senderE, 'beep');
                        success = success &amp;&amp; (start === 2);
                        flapjax.sendEvent(senderE, 'beep');
                        success = success &amp;&amp; (start === -4);
                        return success;
                })(), true, 'bLiftE7');

        bLiftE &amp;= sTest((function (){
                        var success = true;
                        var start = 0;
                        var senderE = flapjax.receiverE();

                        var resE = c.lift_e(
                                        function (x, y) { return x + y; },
                                        senderE,
                                        senderE);

                        e.createNode([resE], function (s, p) { start=p.value; });
                        success = success &amp;&amp; (start === 0);
                        flapjax.sendEvent(senderE, 1);
                        success = success &amp;&amp; (start === 2);
                        flapjax.sendEvent(senderE, 2);
                        success = success &amp;&amp; (start === 4);
                        return success;
                })(), true, 'bLiftE8');

        bLiftE &amp;= sTest((function (){
                        var success = true;
                        var start = 0;
                        var senderE = flapjax.receiverE();

                        var resE = c.lift_e(
                                        function (x, y, z) { return x + y + z; },
                                        senderE,
                                        senderE,
                                        senderE);

                        e.createNode([resE], function (s, p) { start=p.value; });
                        success = success &amp;&amp; (start === 0);
                        flapjax.sendEvent(senderE, 1);
                        success = success &amp;&amp; (start === 3);
                        flapjax.sendEvent(senderE, 2);
                        success = success &amp;&amp; (start === 6);
                        return success;
                })(), true, 'bLiftE9');


        a(bLiftE, 'liftFn');
*/</span>

        bComb &amp;= bEventReceiver &amp;&amp; bSendEvent &amp;&amp; bMapEV &amp;&amp; bFilterEV &amp;&amp; bIfE;
        bComb &amp;= bAndE &amp;&amp; bOrE &amp;&amp; bTimer &amp;&amp; bMergeE &amp;&amp; bLiftE &amp;&amp; bOnceE;
                (bComb? info : error)(<span class="string">'====flapjax.combinators===='</span>);


        <span class="comment">/* behaviors  ____________________________________________*/</span>
                info(<span class="string">'====flapjax.behaviors===='</span>);
        <span class="keyword">var</span> bBehavior = <span class="literal">true</span>;

        <span class="keyword">var</span> beReceiverB = <span class="keyword">new</span> flapjax.Behavior(
                flapjax.receiverE(),
                <span class="number">1</span>);

        bBehavior &amp;= sTest( flapjax.valueNow(beReceiverB), <span class="number">1</span>, <span class="string">'basic behavior'</span>);

        <span class="keyword">var</span> bMapB = <span class="literal">true</span>;
        <span class="keyword">var</span> beMapAdd1B = flapjax.liftB(
                <span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span><span class="keyword">return</span> <span class="number">1</span> + v;},
                beReceiverB);
        bMapB &amp;= sTest( flapjax.valueNow(beMapAdd1B), <span class="number">2</span>, <span class="string">'map init'</span>);
        bMapB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                flapjax.sendEvent(beReceiverB.changes(), <span class="number">3</span>);
                <span class="keyword">return</span> flapjax.valueNow(beMapAdd1B);})(),
                <span class="number">4</span>, <span class="string">'lift_b'</span>);
        a(bMapB, <span class="string">'lift_b'</span>);

        <span class="keyword">var</span> bConstantB = <span class="literal">true</span>;
        <span class="keyword">var</span> beConstant1 = flapjax.constantB(<span class="number">1</span>);
        bConstantB &amp;= sTest(flapjax.valueNow(beConstant1), <span class="number">1</span>, <span class="string">'constant_b'</span>);
        <span class="keyword">var</span> bIfB = <span class="literal">true</span>;

        <span class="keyword">var</span> beIfReceiver = flapjax.constantB(<span class="literal">true</span>);
        <span class="keyword">var</span> beIfThenReceiver = flapjax.constantB(<span class="number">1</span>);
        <span class="keyword">var</span> beIfElseReceiver = flapjax.constantB(<span class="number">2</span>);
        <span class="keyword">var</span> beIf1 = flapjax.ifB(
                 beIfReceiver, beIfThenReceiver, beIfElseReceiver);
    bIfB &amp;= sTest(flapjax.valueNow(beIf1), <span class="number">1</span>, <span class="string">'if_b1'</span>);
        bIfB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                beIfElseReceiver.sendBehavior(<span class="number">7</span>);
                <span class="keyword">return</span> flapjax.valueNow(beIf1);})(),
                <span class="number">1</span>, <span class="string">'if_b2'</span>);
        bIfB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                beIfThenReceiver.sendBehavior(<span class="number">11</span>);
                <span class="keyword">return</span> flapjax.valueNow(beIf1); })(),
                <span class="number">11</span>, <span class="string">'if_b3'</span>);
        bIfB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                beIfReceiver.sendBehavior(<span class="literal">false</span>);
                <span class="keyword">return</span> flapjax.valueNow(beIf1);})(),
                <span class="number">7</span>, <span class="string">'if_b4'</span>);
        bIfB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                beIfElseReceiver.sendBehavior(<span class="number">13</span>);
                <span class="keyword">return</span> flapjax.valueNow(beIf1);})(),
                <span class="number">13</span>, <span class="string">'if_b5'</span>);
        bIfB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                beIfReceiver.sendBehavior(<span class="literal">true</span>);
                <span class="keyword">return</span> flapjax.valueNow(beIf1);})(),
                <span class="number">11</span>, <span class="string">'if_b6'</span>);

        a(bIfB, <span class="string">'if_b'</span>);

        <span class="keyword">var</span> bCondB = <span class="literal">true</span>;

        bCondB &amp;= sTest(
                flapjax.valueNow(flapjax.condB([])),
                <span class="literal">undefined</span>,
                <span class="string">'cond_b1'</span>);

        bCondB &amp;= sTest(
                flapjax.valueNow(
                        flapjax.condB(
                                [flapjax.constantB(<span class="literal">true</span>), <span class="number">1</span>],
                                [flapjax.constantB(<span class="literal">true</span>), <span class="number">2</span>])),
                <span class="number">1</span>, <span class="string">'cond_b2'</span>);

        bCondB &amp;= sTest(
                flapjax.valueNow(
                        flapjax.condB(
                                [flapjax.constantB(<span class="literal">false</span>), <span class="number">1</span>],
                                [flapjax.constantB(<span class="literal">true</span>), <span class="number">2</span>])),
                <span class="number">2</span>, <span class="string">'cond_b3'</span>);

        bCondB &amp;= sTest(
                flapjax.valueNow(
                        flapjax.condB(
                                [flapjax.constantB(<span class="literal">true</span>), <span class="number">1</span>],
                                [flapjax.constantB(<span class="literal">false</span>), <span class="number">2</span>])),
                <span class="number">1</span>, <span class="string">'cond_b4'</span>);

        bCondB &amp;= sTest(
                flapjax.valueNow(
                        flapjax.condB(
                                [flapjax.constantB(<span class="literal">false</span>), <span class="number">1</span>],
                                [flapjax.constantB(<span class="literal">false</span>), <span class="number">2</span>])),
                <span class="literal">undefined</span>, <span class="string">'cond_b5'</span>);

        bCondB &amp;= sTest(
                flapjax.valueNow(
                        flapjax.condB(
                                [flapjax.constantB(<span class="literal">true</span>),
                                 flapjax.constantB(<span class="number">1</span>)])),
                <span class="number">1</span>, <span class="string">'cond_b6'</span>);

        bCondB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                        <span class="keyword">var</span> receiverE = flapjax.receiverE();
                        <span class="keyword">var</span> condb =
                                flapjax.condB(
                                        [flapjax.startsWith(receiverE, <span class="literal">false</span>), <span class="number">1</span>]);
                        flapjax.sendEvent(receiverE, <span class="literal">true</span>);
                        <span class="keyword">return</span> flapjax.valueNow(condb);
                })(),
                <span class="number">1</span>, <span class="string">'cond_b7'</span>);

        bCondB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                        <span class="keyword">var</span> receiverE = flapjax.receiverE();
                        <span class="keyword">var</span> condb =
                                flapjax.condB(
                                        [flapjax.startsWith(receiverE, <span class="literal">false</span>), <span class="number">1</span>]);
                        flapjax.sendEvent(receiverE, <span class="literal">false</span>);
                        <span class="keyword">return</span> flapjax.valueNow(condb);
                })(),
                <span class="literal">undefined</span>, <span class="string">'cond_b8'</span>);

        bCondB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                        <span class="keyword">var</span> receiverE = flapjax.receiverE();
                        <span class="keyword">var</span> condb =
                                flapjax.condB(
                                        [<span class="literal">true</span>, <span class="number">1</span>],
                                        [flapjax.startsWith(receiverE, <span class="literal">false</span>), <span class="number">2</span>]);
                        flapjax.sendEvent(receiverE, <span class="literal">true</span>);
                        <span class="keyword">return</span> flapjax.valueNow(condb);
                })(),
                <span class="number">1</span>, <span class="string">'cond_b9'</span>);


        a(bCondB, <span class="string">'cond_b'</span>);

        <span class="keyword">var</span> bLiftB = <span class="literal">true</span>;
        <span class="keyword">var</span> liftBConstF = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> <span class="number">2</span>; };
        bLiftB &amp;= sTest(flapjax.valueNow(flapjax.liftB(liftBConstF)),
                <span class="number">2</span>, <span class="string">'lift_b1'</span>);

        <span class="keyword">var</span> liftB1F = <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span> <span class="keyword">return</span> <span class="number">1</span> + x; };
        <span class="keyword">var</span> liftBa1 = flapjax.constantB(<span class="number">3</span>);
        <span class="keyword">var</span> liftedB2 = flapjax.liftB(liftB1F, liftBa1);
        bLiftB &amp;= sTest(flapjax.valueNow(liftedB2), <span class="number">4</span>, <span class="string">'lift_b2'</span>);
        bLiftB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                liftBa1.sendBehavior(<span class="number">5</span>);
                <span class="keyword">return</span> flapjax.valueNow(liftedB2);
                })(), <span class="number">6</span>, <span class="string">'lift_b3'</span>);
        <span class="keyword">var</span> liftB2F = <span class="function"><span class="keyword">function</span> <span class="params">(x, y)</span> {</span> <span class="keyword">return</span> x + y; };
        <span class="keyword">var</span> liftBa2 = flapjax.constantB(<span class="number">3</span>);
        <span class="keyword">var</span> liftedB3 = flapjax.liftB(liftB2F, liftBa1, liftBa2);
        bLiftB &amp;= sTest(flapjax.valueNow(liftedB3), <span class="number">8</span>, <span class="string">'lift_b4'</span>);
        bLiftB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                liftBa2.sendBehavior(<span class="number">7</span>);
                <span class="keyword">return</span> flapjax.valueNow(liftedB3);
                })(), <span class="number">12</span>, <span class="string">'lift_b4'</span>);
        bLiftB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                liftBa1.sendBehavior(<span class="number">11</span>);
                <span class="keyword">return</span> flapjax.valueNow(liftedB3);
                })(), <span class="number">18</span>, <span class="string">'lift_b5'</span>);
    bLiftB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">var</span> hit = <span class="number">0</span>;
        <span class="keyword">var</span> r = flapjax.receiverE();
        <span class="keyword">var</span> fnB = flapjax.startsWith(r, <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span> hit = x; <span class="keyword">return</span> x; });
        flapjax.liftB(fnB, <span class="number">5</span>);
        <span class="keyword">return</span> hit;
        })(), <span class="number">5</span>, <span class="string">'lift_b6'</span>);
   bLiftB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">var</span> hit = <span class="number">0</span>;
        <span class="keyword">var</span> r = flapjax.receiverE();
        <span class="keyword">var</span> fnB = flapjax.startsWith(r, <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span> hit = x; <span class="keyword">return</span> x; });
        flapjax.liftB(fnB, <span class="number">5</span>);
        flapjax.sendEvent(r, <span class="function"><span class="keyword">function</span> <span class="params">(y)</span> {</span> hit = y * <span class="number">2</span>; <span class="keyword">return</span> y * <span class="number">2</span>; });
        <span class="keyword">return</span> hit;
        })(), <span class="number">10</span>, <span class="string">'lift_b7'</span>);
        a(bLiftB, <span class="string">'lift_b'</span>);

        <span class="keyword">var</span> bAndB = <span class="literal">true</span>;
        <span class="keyword">var</span> andB0 = flapjax.andB();
        bAndB &amp;= sTest(flapjax.valueNow(andB0), <span class="literal">true</span>, <span class="string">'and_b1'</span>);
        <span class="keyword">var</span> andBa1 = flapjax.constantB( <span class="literal">true</span>);
        <span class="keyword">var</span> andBa2 = flapjax.constantB( <span class="literal">false</span>);
        <span class="keyword">var</span> andB11 = flapjax.andB( andBa1);
        <span class="keyword">var</span> andB12 = flapjax.andB( andBa2);
        <span class="keyword">var</span> andB2 = flapjax.andB( andBa1, andBa2);
        bAndB &amp;= sTest(flapjax.valueNow(andB11), <span class="literal">true</span>, <span class="string">'and_b2'</span>);
        bAndB &amp;= sTest(flapjax.valueNow(andB12), <span class="literal">false</span>, <span class="string">'and_b3'</span>);
        bAndB &amp;= sTest(flapjax.valueNow(andB2), <span class="literal">false</span>, <span class="string">'and_b4'</span>);
        bAndB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                andBa2.sendBehavior(<span class="literal">true</span>);
                <span class="keyword">return</span> flapjax.valueNow(andB12);
                })(), <span class="literal">true</span>, <span class="string">'and_b5'</span>);
        bAndB &amp;= sTest(flapjax.valueNow(andB2), <span class="literal">true</span>, <span class="string">'and_b6'</span>);
        bAndB &amp;= sTest( (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                andBa1.sendBehavior(<span class="literal">false</span>);
                <span class="keyword">return</span> flapjax.valueNow(andB11);
                })(), <span class="literal">false</span>, <span class="string">'and_b6'</span>);
        bAndB &amp;= sTest(flapjax.valueNow(andB2), <span class="literal">false</span>, <span class="string">'and_b7'</span>);

        a(bAndB, <span class="string">'and_b'</span>);


        <span class="keyword">var</span> bSwitchB = <span class="literal">true</span>;

        bSwitchE &amp;=
                sTest(
                        (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                                <span class="keyword">var</span> stream1E = flapjax.receiverE();
                                <span class="keyword">var</span> stream1B = flapjax.startsWith( stream1E, <span class="number">1</span>);
                                <span class="keyword">var</span> stream2E = flapjax.receiverE();
                                <span class="keyword">var</span> stream2B = flapjax.startsWith( stream2E, <span class="number">2</span>);
                                <span class="keyword">var</span> streamReceiverE = flapjax.receiverE();
                                <span class="keyword">var</span> streamReceiverB = flapjax.startsWith( streamReceiverE, flapjax.constantB( <span class="number">0</span>));
                                <span class="keyword">var</span> switchedB = flapjax.switchB( streamReceiverB);
                                <span class="keyword">return</span> flapjax.valueNow(switchedB);
                        })(),
                        <span class="number">0</span>,
                        <span class="string">'switch_b1'</span>);

        bSwitchE &amp;=
                sTest(
                        (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                                <span class="keyword">var</span> stream1E = flapjax.receiverE();
                                <span class="keyword">var</span> stream1B = flapjax.startsWith( stream1E, <span class="number">1</span>);
                                <span class="keyword">var</span> stream2E = flapjax.receiverE();
                                <span class="keyword">var</span> stream2B = flapjax.startsWith( stream2E, <span class="number">2</span>);
                                <span class="keyword">var</span> streamReceiverE = flapjax.receiverE();
                                <span class="keyword">var</span> streamReceiverB = flapjax.startsWith( streamReceiverE, flapjax.constantB( <span class="number">0</span>));
                                <span class="keyword">var</span> switchedB = flapjax.switchB( streamReceiverB);
                                flapjax.sendEvent(streamReceiverE, stream1B);
                                <span class="keyword">return</span> flapjax.valueNow(switchedB);
                        })(),
                        <span class="number">1</span>,
                        <span class="string">'switch_b2'</span>);

        bSwitchE &amp;=
                sTest(
                        (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                                <span class="keyword">var</span> stream1E = flapjax.receiverE();
                                <span class="keyword">var</span> stream1B = flapjax.startsWith( stream1E, <span class="number">1</span>);
                                <span class="keyword">var</span> stream2E = flapjax.receiverE();
                                <span class="keyword">var</span> stream2B = flapjax.startsWith( stream2E, <span class="number">2</span>);
                                <span class="keyword">var</span> streamReceiverE = flapjax.receiverE();
                                <span class="keyword">var</span> streamReceiverB = flapjax.startsWith( streamReceiverE, flapjax.constantB( <span class="number">0</span>));
                                <span class="keyword">var</span> switchedB = flapjax.switchB( streamReceiverB);
                                flapjax.sendEvent(streamReceiverE, stream1B);
                                flapjax.sendEvent(stream1E, <span class="number">2</span>);
                                <span class="keyword">return</span> flapjax.valueNow(switchedB);
                        })(),
                        <span class="number">2</span>,
                        <span class="string">'switch_b3'</span>);

        bSwitchE &amp;=
                sTest(
                        (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                                <span class="keyword">var</span> stream1E = flapjax.receiverE();
                                <span class="keyword">var</span> stream1B = flapjax.startsWith( stream1E, <span class="number">1</span>);
                                <span class="keyword">var</span> stream2E = flapjax.receiverE();
                                <span class="keyword">var</span> stream2B = flapjax.startsWith( stream2E, <span class="number">2</span>);
                                <span class="keyword">var</span> streamReceiverE = flapjax.receiverE();
                                <span class="keyword">var</span> streamReceiverB = flapjax.startsWith( streamReceiverE, flapjax.constantB( <span class="number">0</span>));
                                <span class="keyword">var</span> switchedB = flapjax.switchB( streamReceiverB);
                                flapjax.sendEvent(streamReceiverE, stream1B);
                                flapjax.sendEvent(streamReceiverE, stream2B);
                                <span class="keyword">return</span> flapjax.valueNow(switchedB);
                        })(),
                        <span class="number">2</span>,
                        <span class="string">'switch_b4'</span>);

        bSwitchE &amp;=
                sTest(
                        (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                                <span class="keyword">var</span> stream1E = flapjax.receiverE();
                                <span class="keyword">var</span> stream1B = flapjax.startsWith( stream1E, <span class="number">1</span>);
                                <span class="keyword">var</span> stream2E = flapjax.receiverE();
                                <span class="keyword">var</span> stream2B = flapjax.startsWith( stream2E, <span class="number">2</span>);
                                <span class="keyword">var</span> streamReceiverE = flapjax.receiverE();
                                <span class="keyword">var</span> streamReceiverB = flapjax.startsWith( streamReceiverE, flapjax.constantB( <span class="number">0</span>));
                                <span class="keyword">var</span> switchedB = flapjax.switchB( streamReceiverB);
                                flapjax.sendEvent(streamReceiverE, stream1B);
                                flapjax.sendEvent(streamReceiverE, stream2B);
                                flapjax.sendEvent(stream1E, <span class="number">1</span>);
                                <span class="keyword">return</span> flapjax.valueNow(switchedB);
                        })(),
                        <span class="number">2</span>,
                        <span class="string">'switch_b5'</span>);

        bSwitchE &amp;=
                sTest(
                        (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                                <span class="keyword">var</span> stream1E = flapjax.receiverE();
                                <span class="keyword">var</span> stream1B = flapjax.startsWith( stream1E, <span class="number">1</span>);
                                <span class="keyword">var</span> stream2E = flapjax.receiverE();
                                <span class="keyword">var</span> stream2B = flapjax.startsWith( stream2E, <span class="number">2</span>);
                                <span class="keyword">var</span> streamReceiverE = flapjax.receiverE();
                                <span class="keyword">var</span> streamReceiverB = flapjax.startsWith( streamReceiverE, flapjax.constantB( <span class="number">0</span>));
                                <span class="keyword">var</span> switchedB = flapjax.switchB( streamReceiverB);
                                flapjax.sendEvent(streamReceiverE, stream1B);
                                flapjax.sendEvent(streamReceiverE, stream2B);
                                flapjax.sendEvent(stream2E, <span class="number">3</span>);
                                <span class="keyword">return</span> flapjax.valueNow(switchedB);
                        })(),
                        <span class="number">3</span>,
                        <span class="string">'switch_b6'</span>);


        bSwitchE &amp;=
                sTest(
                        (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                                <span class="keyword">var</span> stream1E = flapjax.receiverE();
                                <span class="keyword">var</span> stream1B = flapjax.startsWith( stream1E, <span class="number">1</span>);
                                <span class="keyword">var</span> stream2E = flapjax.receiverE();
                                <span class="keyword">var</span> stream2B = flapjax.startsWith( stream2E, <span class="number">2</span>);
                                <span class="keyword">var</span> streamReceiverE = flapjax.receiverE();
                                <span class="keyword">var</span> streamReceiverB = flapjax.startsWith( streamReceiverE, flapjax.constantB( <span class="number">0</span>));
                                <span class="keyword">var</span> switchedB = flapjax.switchB( streamReceiverB);
                                flapjax.sendEvent(streamReceiverE, stream1B);
                                flapjax.sendEvent(streamReceiverE, stream2B);
                                flapjax.sendEvent(stream1E, <span class="number">1</span>);
                                <span class="keyword">return</span> flapjax.valueNow(switchedB);
                        })(),
                        <span class="number">2</span>,
                        <span class="string">'switch_b1'</span>);

        a(bSwitchB, <span class="string">'switch_b'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>TODO test or_b</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        bBehavior &amp;= bMapB &amp;&amp; bConstantB &amp;&amp; bIfB &amp;&amp; bCondB &amp;&amp; bLiftB &amp;&amp; bAndB;
                (bBehavior? info : error)(<span class="string">'====flapjax.behavior===='</span>);

        <span class="keyword">return</span> <span class="literal">true</span>;
};
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
