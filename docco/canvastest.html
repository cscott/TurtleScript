<!DOCTYPE html>

<html>
<head>
  <title>canvastest.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="asm-llvm.html">
                asm-llvm.js
              </a>
            
              
              <a class="source" href="bcompile.html">
                bcompile.js
              </a>
            
              
              <a class="source" href="binterp.html">
                binterp.js
              </a>
            
              
              <a class="source" href="browsercanvas.html">
                browsercanvas.js
              </a>
            
              
              <a class="source" href="bytecode-table.html">
                bytecode-table.js
              </a>
            
              
              <a class="source" href="canvastest.html">
                canvastest.js
              </a>
            
              
              <a class="source" href="ccanvas.html">
                ccanvas.js
              </a>
            
              
              <a class="source" href="crender-styles.html">
                crender-styles.js
              </a>
            
              
              <a class="source" href="crender.html">
                crender.js
              </a>
            
              
              <a class="source" href="ctiles.html">
                ctiles.js
              </a>
            
              
              <a class="source" href="events.html">
                events.js
              </a>
            
              
              <a class="source" href="eventtests.html">
                eventtests.js
              </a>
            
              
              <a class="source" href="extensions.html">
                extensions.js
              </a>
            
              
              <a class="source" href="global-es5.html">
                global-es5.js
              </a>
            
              
              <a class="source" href="global.html">
                global.js
              </a>
            
              
              <a class="source" href="html-escape.html">
                html-escape.js
              </a>
            
              
              <a class="source" href="jcompile.html">
                jcompile.js
              </a>
            
              
              <a class="source" href="json2.html">
                json2.js
              </a>
            
              
              <a class="source" href="nodemain.html">
                nodemain.js
              </a>
            
              
              <a class="source" href="parse.html">
                parse.js
              </a>
            
              
              <a class="source" href="render.html">
                render.js
              </a>
            
              
              <a class="source" href="render2.html">
                render2.js
              </a>
            
              
              <a class="source" href="require.html">
                require.js
              </a>
            
              
              <a class="source" href="stdlib.html">
                stdlib.js
              </a>
            
              
              <a class="source" href="str-escape.html">
                str-escape.js
              </a>
            
              
              <a class="source" href="tdop.html">
                tdop.js
              </a>
            
              
              <a class="source" href="tests.html">
                tests.js
              </a>
            
              
              <a class="source" href="text.html">
                text.js
              </a>
            
              
              <a class="source" href="tiles.html">
                tiles.js
              </a>
            
              
              <a class="source" href="tokenize.html">
                tokenize.js
              </a>
            
              
              <a class="source" href="top-level.html">
                top-level.js
              </a>
            
              
              <a class="source" href="ts.html">
                ts.js
              </a>
            
              
              <a class="source" href="write-lua-bytecode.html">
                write-lua-bytecode.js
              </a>
            
              
              <a class="source" href="write-lua-ops.html">
                write-lua-ops.js
              </a>
            
              
              <a class="source" href="write-php-bytecode.html">
                write-php-bytecode.js
              </a>
            
              
              <a class="source" href="write-php-ops.html">
                write-php-ops.js
              </a>
            
              
              <a class="source" href="write-rust-bytecode.html">
                write-rust-bytecode.js
              </a>
            
              
              <a class="source" href="write-rust-ops.html">
                write-rust-ops.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>canvastest.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>define([<span class="hljs-string">"./browsercanvas"</span>,<span class="hljs-string">"ts!gfx/gfx"</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">browsercanvas, gfx</span>) </span>{
<span class="hljs-comment">/*
if (window.navigator.userAgent.indexOf('iPhone') != -1) {
  if (!window.navigator.standalone == true) {
</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>XXX display message prompting to add this app to the home screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  }
}
*/
var world;

var setup = function(canvas, uiEvents) {
    world = gfx.WorldView.New();
    world.canvas = canvas;
    world.strokeColor = gfx.Color.black;
    world.fillColor = gfx.Color.white;</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>test content</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> star = gfx.Polygon.newStar(<span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">30</span>).shapedView();
    star.strokeColor = gfx.Color.blue;
    star.fillColor = gfx.Color.red;
    star.strokeWidth = <span class="hljs-number">4</span>;
    star = star.transformView();
    star.translateBy(gfx.Point.New(<span class="hljs-number">100</span>,<span class="hljs-number">100</span>));
    world.addFirst(star);</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Simplest possible widget; fill entire bounding box.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> BB = {
        <span class="hljs-attr">__proto__</span>: gfx.ComposableView,
        <span class="hljs-attr">bounds</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> gfx.Rectangle.New(gfx.Point.zero,
                                     gfx.Point.New(<span class="hljs-number">30</span>,<span class="hljs-number">30</span>));
        },
        <span class="hljs-attr">drawOn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">canvas, clipRect</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>ignore cliprect, just draw!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            canvas.setFill(gfx.Color.grey);
            canvas.beginPath();
            canvas.rect(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">30</span>,<span class="hljs-number">30</span>);
            canvas.fill();
        }
    };
    <span class="hljs-keyword">var</span> bb = BB.New();
    bb = bb.transformView();
    bb.translateBy(gfx.Point.New(<span class="hljs-number">50</span>,<span class="hljs-number">50</span>));
    bb.touchStartEvent = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
        event.handler.beginDragging(bb, event);
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Hello, world text.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> str = <span class="hljs-string">"_abcdefghijklmnopqrstuvwxyz0123456789,'ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>;
    <span class="hljs-keyword">var</span> hello = gfx.TextView.New(world, str);
    hello.fontHeight = <span class="hljs-number">20</span>;
    hello.strokeColor = gfx.Color.black;
    hello = hello.transformView();
    hello.translateBy(gfx.Point.New(<span class="hljs-number">100</span>,<span class="hljs-number">100</span>));
    world.addLast(hello);
    world.addLast(bb);</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>size feedback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> sizeWidget = gfx.TextView.New(world, <span class="hljs-string">"x"</span>);
    sizeWidget.fillColor = <span class="hljs-literal">null</span>; <span class="hljs-comment">// transparent</span>
    sizeWidget.strokeColor = gfx.Color.black;
    world.addFirst(sizeWidget.transformView().translateBy(gfx.Point.New(<span class="hljs-number">5</span>,<span class="hljs-number">5</span>)));</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>allow dragging the star</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    star.touchStartEvent = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
        event.handler.beginDragging(star, event);
    };
    world.resizeEvent = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
        canvas.resize(event.width, event.height, event.devicePixelRatio);
        sizeWidget.text = event.width+<span class="hljs-string">"x"</span>+event.height+<span class="hljs-string">" "</span>+event.orientation;
        world.damaged();
    };
    uiEvents.mapE(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-built_in">console</span>.assert(e.name, e);
        world.dispatchEvent(e);
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>XXX used to put a widget at every touch to demonstrate multitouch</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>};

<span class="hljs-keyword">var</span> drawFrame = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (!world.damage) <span class="hljs-keyword">return</span>;
  world.forceDamageToScreen();
};</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>start it up!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>browsercanvas.initEventLoop(<span class="hljs-string">'canvas'</span>, setup, drawFrame);

});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
