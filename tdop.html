
<!-- saved from url=(0047)http://javascript.crockford.com/tdop/index.html -->
<HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <TITLE>Top Down Operator Precedence</TITLE>
    <STYLE>
th {background-color: thistle; border: black solid 1px; text-align: left;
    padding-left: 10px; padding-right: 10px; vertical-align: top;}
td {background-color: white; border: black solid 1pt; padding-left: 10px;
    padding-right: 10px; vertical-align: top;}
table {width: 90%; border: 0px; cellpadding: 0px;}
    </STYLE>
<STYLE type="text/css" style="display: none !important;">object:not([type]),object[classid$=":D27CDB6E-AE6D-11cf-96B8-444553540000"],object[classid$=":d27cdb6e-ae6d-11cf-96b8-444553540000"],object[codebase*="swflash.cab"],object[data*=".swf"],embed[type="application/x-shockwave-flash"],embed[src*=".swf"],object[type="application/x-shockwave-flash"],object[src*=".swf"],object[codetype="application/x-shockwave-flash"],iframe[type="application/x-shockwave-flash"],object[classid$=":166B1BCA-3F9C-11CF-8075-444553540000"],object[codebase*="sw.cab"],object[data*=".dcr"],embed[type="application/x-director"],embed[src*=".dcr"],object[type="application/x-director"],object[src*=".dcr"],object[classid$=":15B782AF-55D8-11D1-B477-006097098764"],object[codebase*="awswaxf.cab"],object[data*=".aam"],embed[type="application/x-authorware-map"],embed[src*=".aam"],object[type="application/x-authorware-map"],object[src*=".aam"],object[classid*="32C73088-76AE-40F7-AC40-81F62CB2C1DA"],object[type="application/ag-plugin"],object[type="application/x-silverlight"],object[type="application/x-silverlight-2"],object[source*=".xaml"],object[sourceelement*="xaml"],embed[type="application/ag-plugin"],embed[source*=".xaml"]{display: none !important;}</STYLE></HEAD><BODY bgcolor="linen">
<H1>Top Down Operator Precedence</H1>

<P><A href="http://www.crockford.com/">Douglas Crockford</A></P>

<P>2007-08-05</P>

<H2>Demonstration</H2>
<P>This is the companion file to my paper on <A href="http://javascript.crockford.com/tdop/tdop.html">Vaughan
  Pratt's Top Down Operator Precedence</A>. The paper presents a parser
  for Simplified JavaScript that is written in Simplified Javascript. It
  is chapter 9 of <A href="http://www.amazon.com/exec/obidos/ASIN/0596510047/wrrrldwideweb">Beautiful
  Code</A>. This page loads that parser and runs the parser on itself. </P>
<P>This page loads three JavaScript files:</P>
<TABLE border="0" align="center">
  <TBODY><TR>
    <TD valign="top"><A href="./tokens.js">tokens.js</A></TD>
    <TD>This file installs the <CODE>String.prototype.tokens</CODE> method. It
      produces an array of simple tokens from a string.</TD>
  </TR>
  <TR>
    <TD valign="top"><A href="./parse.js">parse.js</A></TD>
    <TD>This file installs the <CODE>make_parse</CODE> function which produces
      the parse function. The indirection was done so that we could conveniently
      recover the source of the function.</TD>
  </TR>
  <TR>
    <TD valign="top"><A href="http://json.org/json2.js">json2.js</A></TD>
    <TD>This file installs the <CODE>JSON.stringify</CODE> method.
      It is used to display the parse tree.</TD>
  </TR>
</TBODY></TABLE>
<P>The text that follows is the parse tree that the parser generated by
  parsing itself. </P>
<NOSCRIPT></NOSCRIPT>
<SCRIPT src="./tokens.js"></SCRIPT>
<SCRIPT src="./parse.js"></SCRIPT>
<SCRIPT src="./json2.js"></SCRIPT>
<PRE><SCRIPT>
/*jslint evil: true */

/*members create, error, message, name, prototype, stringify, toSource,
    toString, write
*/

/*global JSON, make_parse, parse, source, tree */

// Make a new object that inherits members from an existing object.

if (typeof Object.create !== 'function') {
    Object.create = function (o) {
        function F() {}
        F.prototype = o;
        return new F();
    };
}

// Transform a token object into an exception object and throw it.

Object.prototype.error = function (message, t) {
    t = t || this;
    t.name = "SyntaxError";
    t.message = message;
    throw t;
};


try {
    parse = make_parse();

// We are going to make the parse function parse itself.

    source = make_parse.toSource ?
            make_parse.toSource() : make_parse.toString();
    source = "var make_parse = " + source + ";";
    tree = parse(source);
    if (tree) {
        document.write(JSON.stringify(tree, ['key', 'name', 'message',
            'value', 'arity', 'first', 'second', 'third', 'fourth'], 4));
    }

} catch (e) {
    document.write(JSON.stringify(e, ['name', 'message', 'from', 'to', 'key',
            'value', 'arity', 'first', 'second', 'third', 'fourth'], 4));
}

</SCRIPT>
</PRE>


</BODY></HTML>
